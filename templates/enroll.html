<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/ui.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <title>UI</title>
</head>

<body>
    <div class="neclogo">
        <img class="neclogo" src="https://www.nec.com/nf_global/v3/common/img/site/header-img.webp" />
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-10 offset=md-1">
                <div class="row">
                    <div class="col-md-5 register-right">
                        <h5> Register here for Voice Enrollement</h5>
                        <div class="voice-register">
                            <div class="form-group">
                                <input type="text" id="userName" name="userName" class="form-control"
                                    placeholder="Enter Name">
                                <br>
                                <input type="text" id="emailID" name="emailID" class="form-control"
                                    placeholder="Enter email ID">
                            </div>
                            <hr>
                            <br>
                            <a style="width: 300px" class="link" href="http://127.0.0.1:5000/verify">Already a user?</a>
                            <button class="btn-primary" style="width: 150px" onclick="enrollNewProfile();">Enroll
                                Me</button>
                        </div>
                    </div>
                </div>
                <img class="bg-img-enroll" src="static/images/necspeakerrec.jpg" alt="img">
            </div>
        </div>
    </div>
    <div>
        
    </div>
    <pre id="log"></pre>
    <br>
    <script src="{{ url_for('static', filename='src/recorder.js') }}"></script>
    <script src="{{ url_for('static', filename='src/phrases.js') }}">
    </script>
    <script src="{{ url_for('static', filename='src/speaker-recognition.js') }}">
    </script>
    
    <script>
        var recorder;
        var audio_context;

        function onMediaSuccess(stream, callback, secondsOfAudio) {
            audio_context = audio_context || new window.AudioContext;
            var input = audio_context.createMediaStreamSource(stream);
            recorder = new Recorder(input);
            recorder.record();

            setTimeout(() => {
                StopListening(callback);
            }, secondsOfAudio * 1000);
        }

        function onMediaError(e) {
            console.error('media error', e);
        }

        function StopListening(callback) {
            console.log('...working...');
            recorder && recorder.stop();
            recorder.exportWAV(function (blob) {
                callback(blob);
            });
            recorder.clear();
        }
    </script>
    
</body>

</html>